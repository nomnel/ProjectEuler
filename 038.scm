(add-load-path "." :relative)
(use eulerlib)

; (連結数) -> (許容される整数の範囲) とすると
; 9 -> 1
; 8 -> 無
; 7 -> 無
; 6 -> 3
; 5 -> 5 - 9
; 4 -> 25 - 33
; 3 -> 100 - 333
; 2 -> 5000 - 9999
; よって, 9182 - 9999 の範囲を調べればよい.
(define (e38)
  (fold (^(n p) (let1 i (+ (* n 100000) (* n 2))
                  (if (and (pandigital? i) (< p i))
                      i p)))
        918273645
        (range 9182 10000)))